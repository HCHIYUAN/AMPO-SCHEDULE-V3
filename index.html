<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éƒ¨é–€å‹•æ…‹ç®¡ç†ç³»çµ± V20 (é€£ç·šè¨ºæ–·ç‰ˆ)</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Import Map -->
    <script type="importmap">
    {
        "imports": {
            "react": "https://esm.sh/react@18.2.0",
            "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
            "lucide-react": "https://esm.sh/lucide-react@0.292.0",
            "firebase/app": "https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js",
            "firebase/firestore": "https://www.gstatic.com/firebasejs/11.0.2/firebase-firestore.js"
        }
    }
    </script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@500&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; }
        input[type="datetime-local"] { font-family: 'Roboto Mono', monospace; }
    </style>
</head>
<body class="bg-slate-100 min-h-screen text-slate-800 selection:bg-indigo-100">
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import React, { useState, useEffect, useMemo } from 'react';
        import { createRoot } from 'react-dom/client';
        import { 
            User, Briefcase, Calendar, Plane, Home, Clock, Plus, X, 
            ChevronLeft, ChevronRight, LayoutGrid, List, CalendarDays, Edit3, Settings, Trash2, Save, CalendarRange, AlertCircle, Cloud, RefreshCw, CalendarCheck, Coffee, Info, Utensils, Globe, PartyPopper, GraduationCap, Megaphone, Cake, HelpCircle, Tag, CheckCircle2, Activity
        } from 'lucide-react';
        
        import { initializeApp } from "firebase/app";
        import { getFirestore, collection, addDoc, updateDoc, deleteDoc, doc, onSnapshot, query, orderBy, writeBatch } from "firebase/firestore";

        // ==========================================
        // ğŸ”¥ è¨­å®šå€ (æ‚¨çš„ Firebase è¨­å®š) ğŸ”¥
        // ==========================================
        const firebaseConfig = {
  apiKey: "AIzaSyCjFPZ3eFwCOHDh-O0FwynEPfcxaCXiSMo",
  authDomain: "ampo-schedule-v1.firebaseapp.com",
  projectId: "ampo-schedule-v1",
  storageBucket: "ampo-schedule-v1.firebasestorage.app",
  messagingSenderId: "32368367144",
  appId: "1:32368367144:web:97ded59a7643d7fcb3c71d"
};

        // --- å…¨åŸŸè®Šæ•¸ ---
        let db;
        let systemLogs = []; // æš«å­˜æ—¥èªŒ

        // --- è¼”åŠ©ï¼šå¯«å…¥æ—¥èªŒ ---
        const addLog = (msg, type = 'info') => {
            const time = new Date().toLocaleTimeString();
            const logEntry = { time, msg, type };
            systemLogs.push(logEntry);
            console.log(`[${type.toUpperCase()}] ${msg}`);
            // ç™¼é€äº‹ä»¶é€šçŸ¥ React æ›´æ–° (ç°¡å–®å¯¦ä½œ)
            const event = new CustomEvent('logUpdated');
            window.dispatchEvent(event);
        };

        // --- åˆå§‹åŒ– Firebase ---
        try {
            addLog("æ­£åœ¨æª¢æŸ¥è¨­å®šæª”...");
            if (firebaseConfig.apiKey && !firebaseConfig.apiKey.includes("è«‹å¡«å…¥")) {
                addLog("è¨­å®šæª”æ ¼å¼æ­£ç¢ºï¼Œæ­£åœ¨åˆå§‹åŒ– Firebase App...");
                const app = initializeApp(firebaseConfig);
                addLog("Firebase App åˆå§‹åŒ–æˆåŠŸ");
                
                db = getFirestore(app);
                addLog("Firestore è³‡æ–™åº«é€£çµç‰©ä»¶å»ºç«‹æˆåŠŸ");
            } else {
                addLog("âŒ è¨­å®šæª”éŒ¯èª¤ï¼šapiKey ä¼¼ä¹æœªå¡«å¯«", 'error');
            }
        } catch (e) { 
            addLog(`âŒ Firebase åˆå§‹åŒ–å¤±æ•—: ${e.message}`, 'error'); 
        }

        // --- å¸¸æ•¸è¨­å®š ---
        const WORK_START_HOUR = 8;
        const WORK_END_HOUR = 17; 
        const TIME_OPTIONS = [];
        for (let h = WORK_START_HOUR; h <= 18; h++) {
            const hourStr = h < 10 ? `0${h}` : `${h}`;
            TIME_OPTIONS.push(`${hourStr}:00`);
            if (h < 18) TIME_OPTIONS.push(`${hourStr}:30`);
        }

        const STATUS_TYPES = {
            office: { id: 'office', label: 'å‡ºå‹¤', color: 'bg-white text-emerald-600 border-emerald-200 ring-1 ring-emerald-100', circle: 'bg-emerald-50 text-emerald-600 border border-emerald-200', icon: User },
            meeting: { id: 'meeting', label: 'æœƒè­°', color: 'bg-blue-50 text-blue-700 border-blue-200', circle: 'bg-blue-500 text-white', icon: Briefcase },
            trip: { id: 'trip', label: 'å‡ºå·®', color: 'bg-purple-50 text-purple-700 border-purple-200', circle: 'bg-purple-500 text-white', icon: Plane },
            leave: { id: 'leave', label: 'ä¼‘å‡', color: 'bg-rose-50 text-rose-700 border-rose-200', circle: 'bg-rose-500 text-white', icon: Home },
            break: { id: 'break', label: 'ä¸‹ç­/ä¼‘å‡', color: 'bg-slate-50 text-slate-400 border-slate-200', circle: 'bg-slate-200 text-slate-400', icon: Clock },
        };
        const SPECIAL_TYPES = ['meeting', 'trip', 'leave'];
        const DEFAULT_EVENT_TYPES = {
            client: { id: 'client', label: 'å®¢æˆ¶ä¾†è¨ª', char: 'å®¢', icon: Globe, color: 'text-teal-700 bg-teal-50 border-teal-200', badge: 'bg-teal-100 text-teal-800 border border-teal-200' },
            dinner: { id: 'dinner', label: 'éƒ¨é–€èšé¤', char: 'èš', icon: Utensils, color: 'text-orange-700 bg-orange-50 border-orange-200', badge: 'bg-orange-100 text-orange-800 border border-orange-200' },
            party: { id: 'party', label: 'æ…¶ç”Ÿ/æ´»å‹•', char: 'æ…¶', icon: PartyPopper, color: 'text-amber-700 bg-amber-50 border-amber-200', badge: 'bg-amber-100 text-amber-800 border border-amber-200' },
            training: { id: 'training', label: 'æ•™è‚²è¨“ç·´', char: 'è¨“', icon: GraduationCap, color: 'text-cyan-700 bg-cyan-50 border-cyan-200', badge: 'bg-cyan-100 text-cyan-800 border border-cyan-200' },
            announce: { id: 'announce', label: 'é‡è¦å…¬å‘Š', char: 'å…¬', icon: Megaphone, color: 'text-slate-600 bg-slate-50 border-slate-200', badge: 'bg-slate-200 text-slate-700 border border-slate-300' },
        };
        const COLOR_PALETTES = {
            red: { label: 'ç´…è‰²', color: 'text-red-700 bg-red-50 border-red-200', badge: 'bg-red-100 text-red-800 border-red-200' },
            green: { label: 'ç¶ è‰²', color: 'text-green-700 bg-green-50 border-green-200', badge: 'bg-green-100 text-green-800 border-green-200' },
            blue: { label: 'è—è‰²', color: 'text-blue-700 bg-blue-50 border-blue-200', badge: 'bg-blue-100 text-blue-800 border-blue-200' },
            purple: { label: 'ç´«è‰²', color: 'text-purple-700 bg-purple-50 border-purple-200', badge: 'bg-purple-100 text-purple-800 border-purple-200' },
            pink: { label: 'ç²‰è‰²', color: 'text-pink-700 bg-pink-50 border-pink-200', badge: 'bg-pink-100 text-pink-800 border-pink-200' },
            yellow: { label: 'é»ƒè‰²', color: 'text-yellow-700 bg-yellow-50 border-yellow-200', badge: 'bg-yellow-100 text-yellow-800 border-yellow-200' },
            gray: { label: 'ç°è‰²', color: 'text-gray-700 bg-gray-50 border-gray-200', badge: 'bg-gray-100 text-gray-800 border-gray-200' },
            indigo: { label: 'é›é’', color: 'text-indigo-700 bg-indigo-50 border-indigo-200', badge: 'bg-indigo-100 text-indigo-800 border-indigo-200' },
        };
        const TAIWAN_HOLIDAYS = { '2025-01-01': 'å…ƒæ—¦', '2025-01-25': 'æ˜¥ç¯€', '2025-02-28': '228ç´€å¿µæ—¥', '2025-04-04': 'æ¸…æ˜ç¯€', '2025-05-30': 'ç«¯åˆé€£å‡', '2025-10-10': 'åœ‹æ…¶æ—¥' }; // ç°¡åŒ–ç‰ˆ
        const MAKEUP_WORKDAYS = ['2025-02-08'];

        // --- è¼”åŠ©å‡½æ•¸ ---
        const splitIsoString = (isoStr) => { if (!isoStr) return { datePart: '', timePart: '' }; const date = new Date(isoStr); const pad = (n) => n < 10 ? '0' + n : n; return { datePart: `${date.getFullYear()}-${pad(date.getMonth() + 1)}-${pad(date.getDate())}`, timePart: `${pad(date.getHours())}:${pad(date.getMinutes())}` }; };
        const formatTime24 = (dateStr) => { const d = new Date(dateStr); const pad = (n) => n < 10 ? '0' + n : n; return `${pad(d.getHours())}:${pad(d.getMinutes())}`; };
        const isSameDay = (d1, d2) => d1.getFullYear() === d2.getFullYear() && d1.getMonth() === d2.getMonth() && d1.getDate() === d2.getDate();
        const isDateInRange = (checkDate, startStr, endStr) => { const check = new Date(checkDate); check.setHours(0,0,0,0); const start = new Date(startStr); start.setHours(0,0,0,0); const end = new Date(endStr); end.setHours(0,0,0,0); return check.getTime() >= start.getTime() && check.getTime() <= end.getTime(); };
        const getDateString = (date) => { const pad = (n) => n < 10 ? '0' + n : n; return `${date.getFullYear()}-${pad(date.getMonth() + 1)}-${pad(date.getDate())}`; };
        const isDayOff = (date) => { const dateStr = getDateString(date); if (MAKEUP_WORKDAYS.includes(dateStr)) return false; if (TAIWAN_HOLIDAYS[dateStr]) return TAIWAN_HOLIDAYS[dateStr]; const day = date.getDay(); if (day === 0 || day === 6) return 'é€±æœ«'; return false; };

        // ğŸ”¥ Log Viewer Component ğŸ”¥
        const LogViewer = () => {
            const [logs, setLogs] = useState(systemLogs);
            const [show, setShow] = useState(true);

            useEffect(() => {
                const handler = () => setLogs([...systemLogs]);
                window.addEventListener('logUpdated', handler);
                return () => window.removeEventListener('logUpdated', handler);
            }, []);

            if (!show) return <button onClick={() => setShow(true)} className="fixed bottom-4 left-4 bg-black text-white p-2 rounded-full shadow-lg z-50 text-xs">é¡¯ç¤ºæ—¥èªŒ</button>;

            return (
                <div className="fixed bottom-0 left-0 right-0 h-48 bg-slate-900 text-slate-300 font-mono text-xs p-4 overflow-y-auto z-50 opacity-95 shadow-2xl border-t border-slate-700">
                    <div className="flex justify-between items-center mb-2 border-b border-slate-700 pb-1">
                        <span className="font-bold text-white flex items-center"><Activity className="w-3 h-3 mr-1" /> ç³»çµ±è¨ºæ–·æ—¥èªŒ</span>
                        <button onClick={() => setShow(false)} className="text-slate-400 hover:text-white"><X className="w-4 h-4" /></button>
                    </div>
                    <div className="space-y-1">
                        {logs.map((log, i) => (
                            <div key={i} className={`${log.type === 'error' ? 'text-red-400 font-bold' : log.type === 'success' ? 'text-green-400' : 'text-slate-300'}`}>
                                <span className="opacity-50 mr-2">[{log.time}]</span>
                                {log.msg}
                            </div>
                        ))}
                        {logs.length === 0 && <div>ç­‰å¾…æ´»å‹•...</div>}
                    </div>
                </div>
            );
        };

        function App() {
            const [members, setMembers] = useState([]);
            const [schedules, setSchedules] = useState([]);
            const [events, setEvents] = useState([]); 
            const [customTypes, setCustomTypes] = useState([]); 
            const [loading, setLoading] = useState(false); // ğŸ”¥ å¼·åˆ¶è¨­ç‚º falseï¼Œé¿å…å¡æ­»ç•«é¢
            
            const [currentView, setCurrentView] = useState('dashboard'); 
            const [viewDate, setViewDate] = useState(new Date()); 
            const [isManageModalOpen, setIsManageModalOpen] = useState(false);
            const [isMemberEditModalOpen, setIsMemberEditModalOpen] = useState(false);
            const [isEventModalOpen, setIsEventModalOpen] = useState(false); 
            const [isTypeModalOpen, setIsTypeModalOpen] = useState(false); 
            const [targetMember, setTargetMember] = useState(null); 
            const [modalMode, setModalMode] = useState('list');
            const [statusForm, setStatusForm] = useState({ id: null, type: 'meeting', startDate: '', startTime: '08:00', endDate: '', endTime: '17:00', note: '' });
            const [memberForm, setMemberForm] = useState({ name: '', role: '', birthday: '' });
            const [eventForm, setEventForm] = useState({ id: null, title: '', type: 'client', startDate: '', endDate: '', note: '' });
            const [typeForm, setTypeForm] = useState({ label: '', char: '', colorKey: 'blue' }); 

            useEffect(() => {
                if (!db) { 
                    addLog("ç„¡æ³•å•Ÿå‹•ç›£è½å™¨ï¼šdb ç‰©ä»¶ä¸å­˜åœ¨", 'error'); 
                    return; 
                }
                
                addLog("é–‹å§‹è¨»å†Š Firestore ç›£è½å™¨...");

                // ç›£è½ Members
                const unsubMembers = onSnapshot(query(collection(db, "members"), orderBy("orderId")), (s) => {
                    addLog(`æ¥æ”¶åˆ°æˆå“¡è³‡æ–™: ${s.docs.length} ç­†`, 'success');
                    setMembers(s.docs.map(doc => ({ id: doc.id, ...doc.data() })));
                }, (error) => { 
                    addLog(`âŒ æˆå“¡è®€å–å¤±æ•—: ${error.message}`, 'error'); 
                    if(error.code === 'permission-denied') addLog("è«‹æª¢æŸ¥ Firebase Console -> Rules æ˜¯å¦è¨­ç‚º true", 'error');
                });

                // ç›£è½ Schedules
                const unsubSchedules = onSnapshot(collection(db, "schedules"), (s) => {
                    // addLog(`æ¥æ”¶åˆ°è¡Œç¨‹è³‡æ–™: ${s.docs.length} ç­†`);
                    setSchedules(s.docs.map(doc => ({ id: doc.id, ...doc.data() })));
                }, (error) => addLog(`âŒ è¡Œç¨‹è®€å–å¤±æ•—: ${error.message}`, 'error'));

                // ç›£è½ Events
                const unsubEvents = onSnapshot(query(collection(db, "events")), (s) => { 
                    // addLog(`æ¥æ”¶åˆ°äº‹ä»¶è³‡æ–™: ${s.docs.length} ç­†`);
                    setEvents(s.docs.map(doc => ({ id: doc.id, ...doc.data() })));
                });

                // ç›£è½ Custom Types
                const unsubTypes = onSnapshot(query(collection(db, "custom_types")), (s) => { 
                    setCustomTypes(s.docs.map(doc => ({ id: doc.id, ...doc.data() })));
                });

                return () => { unsubMembers(); unsubSchedules(); unsubEvents(); unsubTypes(); };
            }, []);

            // åˆå§‹åŒ– DB
            const initializeDb = async () => {
                if (!db) return; 
                addLog("é–‹å§‹åˆå§‹åŒ–é è¨­æˆå“¡...", 'info');
                const batch = writeBatch(db);
                for (let i = 1; i <= 12; i++) { 
                    const docRef = doc(collection(db, "members")); 
                    batch.set(docRef, { orderId: i, name: `æˆå“¡${i}`, role: i === 1 ? 'ä¸»ç®¡' : 'å°ˆå“¡' }); 
                }
                try { 
                    await batch.commit(); 
                    addLog("åˆå§‹åŒ–æˆåŠŸï¼", 'success');
                    alert("åˆå§‹åŒ–å®Œæˆï¼"); 
                } catch (e) { 
                    addLog(`âŒ åˆå§‹åŒ–å¤±æ•—: ${e.message}`, 'error');
                    alert("åˆå§‹åŒ–å¤±æ•—: " + e.message); 
                }
            };

            // é‚è¼¯çœç•¥ï¼ŒåŒ V17
            const allEventTypes = useMemo(() => { const combined = { ...DEFAULT_EVENT_TYPES }; customTypes.forEach(t => { const palette = COLOR_PALETTES[t.colorKey] || COLOR_PALETTES.gray; combined[t.id] = { id: t.id, label: t.label, char: t.char, icon: Tag, color: palette.color, badge: palette.badge }; }); return combined; }, [customTypes]);
            const getMemberCurrentStatus = (memberId, time) => { const checkTime = time.getTime(); const currentSchedules = schedules.filter(s => s.memberId === memberId && new Date(s.start).getTime() <= checkTime && new Date(s.end).getTime() > checkTime); if (currentSchedules.length > 0) return { ...currentSchedules[currentSchedules.length - 1], isDefault: false }; const holidayName = isDayOff(time); if (holidayName) return { type: 'break', note: holidayName, isDefault: true }; const hour = time.getHours(); const isWorkTime = hour >= WORK_START_HOUR && hour < WORK_END_HOUR; if (isWorkTime) return { type: 'office', note: 'åœ¨ä½å­ä¸Š', isDefault: true }; return { type: 'break', note: 'éè¾¦å…¬æ™‚é–“', isDefault: true }; };
            const getMemberDaySchedules = (memberId, date) => schedules.filter(s => s.memberId === memberId && isDateInRange(date, s.start, s.end));
            const handleEditMember = (member) => { setTargetMember(member); setMemberForm({ name: member.name, role: member.role, birthday: member.birthday || '' }); setIsMemberEditModalOpen(true); };
            const saveMemberInfo = async (e) => { e.preventDefault(); if (!db) return; try { const memberRef = doc(db, "members", targetMember.id); await updateDoc(memberRef, { name: memberForm.name, role: memberForm.role, birthday: memberForm.birthday }); setIsMemberEditModalOpen(false); } catch (err) { alert("æ›´æ–°å¤±æ•—: " + err.message); } };
            const openManageModal = (member, mode = 'list', baseDate = viewDate) => { setTargetMember(member); setModalMode(mode); const pad = (n) => n < 10 ? '0' + n : n; const defaultDateStr = `${baseDate.getFullYear()}-${pad(baseDate.getMonth() + 1)}-${pad(baseDate.getDate())}`; setStatusForm({ id: null, type: 'trip', startDate: defaultDateStr, startTime: '08:00', endDate: defaultDateStr, endTime: '17:00', note: '' }); setIsManageModalOpen(true); };
            const loadScheduleToForm = (schedule) => { const start = splitIsoString(schedule.start); const end = splitIsoString(schedule.end); setStatusForm({ id: schedule.id, type: schedule.type, startDate: start.datePart, startTime: start.timePart, endDate: end.datePart, endTime: end.timePart, note: schedule.note || '' }); setModalMode('add'); };
            const saveStatus = async (e) => { e.preventDefault(); if (!db) return; const startD = new Date(statusForm.startDate); const endD = new Date(statusForm.endDate); const startHoliday = isDayOff(startD); const endHoliday = isDayOff(endD); if (startHoliday) { alert(`âš ï¸ ç„¡æ³•æ’ç¨‹ï¼š${statusForm.startDate} æ˜¯ã€Œ${startHoliday}ã€ã€‚`); return; } if (endHoliday) { alert(`âš ï¸ ç„¡æ³•æ’ç¨‹ï¼š${statusForm.endDate} æ˜¯ã€Œ${endHoliday}ã€ã€‚`); return; } const startIso = `${statusForm.startDate}T${statusForm.startTime}:00`; const endIso = `${statusForm.endDate}T${statusForm.endTime}:00`; if (new Date(startIso) >= new Date(endIso)) { alert("âš ï¸ çµæŸæ™‚é–“å¿…é ˆæ™šæ–¼é–‹å§‹æ™‚é–“"); return; } const scheduleData = { memberId: targetMember.id, type: statusForm.type, start: startIso, end: endIso, note: statusForm.note }; try { if (statusForm.id) { await updateDoc(doc(db, "schedules", statusForm.id), scheduleData); setModalMode('list'); } else { await addDoc(collection(db, "schedules"), scheduleData); alert("âœ… è¡Œç¨‹å·²åŒæ­¥ï¼"); setStatusForm(prev => ({ ...prev, note: '' })); } } catch (err) { alert("å„²å­˜å¤±æ•—: " + err.message); } };
            const deleteSchedule = async (id) => { if (confirm('ç¢ºå®šåˆªé™¤ï¼Ÿ')) { try { await deleteDoc(doc(db, "schedules", id)); if (statusForm.id === id) setModalMode('list'); } catch (err) { alert("åˆªé™¤å¤±æ•—: " + err.message); } } };
            const openEventModal = (event = null) => { if(event) { setEventForm({ id: event.id, title: event.title, type: event.type, startDate: event.startDate || event.date, endDate: event.endDate || event.date, note: event.note }); } else { const today = getDateString(new Date()); setEventForm({ id: null, title: '', type: 'client', startDate: today, endDate: today, note: '' }); } setIsEventModalOpen(true); };
            const saveEvent = async (e) => { e.preventDefault(); if(!db) return; if (eventForm.startDate > eventForm.endDate) { alert("âš ï¸ çµæŸæ—¥æœŸä¸èƒ½æ—©æ–¼é–‹å§‹æ—¥æœŸ"); return; } const eventData = { title: eventForm.title, type: eventForm.type, startDate: eventForm.startDate, endDate: eventForm.endDate, date: eventForm.startDate, note: eventForm.note }; try { if(eventForm.id) await updateDoc(doc(db, "events", eventForm.id), eventData); else await addDoc(collection(db, "events"), eventData); setIsEventModalOpen(false); } catch(err) { alert("å„²å­˜å¤±æ•—: "+err.message); } };
            const deleteEvent = async (id) => { if(confirm("ç¢ºå®šåˆªé™¤æ­¤æ´»å‹•?")) { await deleteDoc(doc(db, "events", id)); } };
            const saveType = async (e) => { e.preventDefault(); if(!db) return; const id = 'custom_' + Date.now(); try { await addDoc(collection(db, "custom_types"), { id, ...typeForm }); setTypeForm({ label: '', char: '', colorKey: 'blue' }); alert("é¡åˆ¥å·²æ–°å¢"); } catch(err){ alert("å¤±æ•—: "+err.message); } };
            const deleteType = async (id) => { if(confirm("åˆªé™¤æ­¤é¡åˆ¥ï¼Ÿ")) { try { await deleteDoc(doc(db, "custom_types", id)); } catch(e){console.error(e);} }};

            // View Components (Simplified for brevity)
            const DashboardView = () => (<div className="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">{members.map(member => <div key={member.id} className="bg-white rounded-2xl p-4 border border-slate-200"><div className="flex items-center gap-2"><div className="w-10 h-10 bg-slate-100 rounded-full flex items-center justify-center font-bold">{member.name.charAt(0)}</div><div><div className="font-bold">{member.name}</div><div className="text-xs text-slate-400">{member.role}</div></div></div></div>)}</div>);
            
            // --- æ¸²æŸ“ ---
            return (
                <div className="max-w-7xl mx-auto p-4 md:p-6 pb-40">
                    <header className="flex flex-col md:flex-row justify-between items-center mb-6 gap-4 glass-panel p-4 rounded-2xl shadow-sm border border-white sticky top-2 z-20">
                        <div className="flex items-center gap-3"><div className="bg-gradient-to-br from-indigo-500 to-purple-600 p-2.5 rounded-xl shadow-lg shadow-indigo-200 text-white"><LayoutGrid className="w-6 h-6" /></div><div><h1 className="text-xl font-bold text-slate-800 tracking-tight">éƒ¨é–€å‹•æ…‹ç®¡ç†</h1><p className="text-xs text-slate-500 font-medium">V20 é€£ç·šè¨ºæ–·æ¨¡å¼</p></div></div>
                    </header>

                    {/* å¦‚æœæ²’æœ‰æˆå“¡ï¼Œé¡¯ç¤ºåˆå§‹åŒ–æŒ‰éˆ• */}
                    {members.length === 0 ? (
                        <div className="min-h-[50vh] flex flex-col items-center justify-center bg-white rounded-2xl shadow-sm p-8 text-center border-2 border-dashed border-indigo-200">
                            <Cloud className="w-16 h-16 text-indigo-300 mb-4" />
                            <h2 className="text-xl font-bold text-slate-700">è³‡æ–™åº«é€£ç·šä¸­...</h2>
                            <p className="text-slate-500 mb-6 text-sm">å¦‚æœä¸‹æ–¹æ—¥èªŒé¡¯ç¤ºã€ŒæˆåŠŸã€ä½†é€™è£¡é‚„æ˜¯ç©ºçš„ï¼Œè«‹é»æ“Šåˆå§‹åŒ–ã€‚</p>
                            <button onClick={initializeDb} className="px-6 py-3 bg-indigo-600 text-white rounded-xl font-bold shadow-lg hover:bg-indigo-700 transition flex items-center gap-2">
                                <RefreshCw className="w-5 h-5" /> åˆå§‹åŒ– / å»ºç«‹ 12 ä½æˆå“¡
                            </button>
                        </div>
                    ) : (
                        <main>
                            <div className="bg-emerald-50 border border-emerald-200 text-emerald-700 px-4 py-3 rounded-xl mb-4 flex items-center">
                                <CheckCircle2 className="w-5 h-5 mr-2" />
                                æˆåŠŸè®€å–åˆ° {members.length} ä½æˆå“¡è³‡æ–™ï¼ç³»çµ±é‹ä½œæ­£å¸¸ã€‚
                            </div>
                            {/* é€™è£¡ç°¡å–®é¡¯ç¤º Dashboard ç¤ºæ„ï¼Œè­‰æ˜æœ‰æŠ“åˆ°è³‡æ–™ */}
                            <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                                {members.map(m => (
                                    <div key={m.id} className="bg-white p-4 rounded-xl border shadow-sm">
                                        <div className="font-bold text-lg">{m.name}</div>
                                        <div className="text-sm text-slate-500">{m.role}</div>
                                    </div>
                                ))}
                            </div>
                        </main>
                    )}

                    {/* æ—¥èªŒè¦–çª— */}
                    <LogViewer />
                </div>
            );
        }

        const root = createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
